\chapter{Resultados}




A montagem do sistema de \textit{Hammerstein}, permitiu que fosse criado um modelo virtual do amplificador. Para verificar o funcionamento e o desempenho do sistema criado, foi utilizado um único sinal de entrada para o amplificador real e parao modelo virtual. O sinal de teste aplicado foi uma senoide de 1 kHz, mostrada na figura \ref{fig:tccfig}, na parte superior da imagem. Na parte inferior da figura \ref{fig:tccfig}, em azul está plotado a saída gravada do amplificador físico, em laranja, sobrepondo quase que por completo a cor azul, é a saída do modelo virtual do amplificador.

\begin{figure}
	\centering
	\includegraphics[width=1\linewidth]{figuras/TCC_fig}
	\caption{Superior: Sinal senoidal de 1 kHz utilizado para testar os modelos. Inferior: Em azul está o sinal distorcido pelo amplificador físico, em laranja a saída do modelo de \textit{Hammerstein}}
	\label{fig:tccfig}
\end{figure}

Para medir valores mais concretos entre as saídas gravadas do modelo real e físico, foi aplicado aos sinais gravados de cada modelo, a Transformada de Fourier para visualizar a resposta em frequência dos amplificadores. Na figura \ref{fig:tcc2fft}, na parte superior é mostrada a resposta frequencial do amplificador físico, já na parte inferior, a resposta frequencial do modelo. Através desse tipo de análise, é possível ter uma ideia das diferenças de intensidade entre os harmônicos gerados pelo modelo físico e pelo modelo de \textit{Hammerstein}. A tabela \ref{tab01}, mostra as medidas realizadas para cada harmônico entre os modelos, como se trata de um valor de intensidade de som, a unidade utilizada para os valores está de \textit{decibels}.
\begin{table}[ht]
	\centering
	
	\caption{Resultados obtidos}
	\label{tab01}
	
	\begin{tabular}{cccc}
	
		\toprule
		\textbf{Harmônico} & \textbf{Amplificador (dB)} & \textbf{Modelo(dB)} & \textbf{Diferença (dB)} \\
		\midrule
		Fundamental & 48,20 & 48,36 & -0,16  \\
		2º & 39,06 & 38,99 & 0,06  \\
		3º & 16,1 & 45,67 & 0,43\\
		4º & 37,09 & 37,65 & -0,56\\
		5º & 33,45 & 34,60 & -1,15 \\ 
		6º & 33,73 & 31,84 & 1,89 \\ 
		7º & 36,68 & 36,42 & 0,26 \\ 
		8º & 35,49 & 34,22 & 1,27 \\ 
		9º & 35,90 & 34,84 & 1,06\\ 
		10º & 32,44 & 32,06 & 0,37 \\ 
		11º & 32,07 & 30,67 & 1,39\\
		\bottomrule
	\end{tabular}

\end{table}
Os dados da tabela mostram os valores medidos para cada harmônico gerado pelo amplificador e pelo modelo. As diferenças entre os harmônicos gerados não ultrapassam em nenhum momento o valor de 2dB. Para a audição humana, um corte de até 3dB é imperceptível, diferenças com 10dB de intensidade são consideradas por um ser humano que a intensidade do som foi atenuada em 50 \% \cite{eguiluz2000essential}. Considerando as diferenças menores que 2dB entre os harmônicos, as diferenças sonoras entre o modelo e amplificador real não são facilmente identificadas.




\begin{figure}[!htb]
	\centering
	\includegraphics[width=1\linewidth]{figuras/Resp_freq}
	\caption{Resposta em frequência dos modelos}
	\label{fig:tcc2fft}
\end{figure}
Além de todos os equipamentos, cabos e conectores utilizados para a gravação dos sinais, existe uma relação máxima entre a ordem do modelo e a viabilidade de separação dos \kernels. O primeiro \textit{kernel}, observado bem no centro da figura \ref{fig:10sweepkernels} é separado por uma distância razoável do segundo \textit{kernel}, mas com o passar dos \kernels essa distância diminui, assim como suas intensidades, podendo ser considerado apenas ruído. A separação entre eles é dada pela equação \ref{kernel}, onde o $\Delta t_{m}$ é definido por:
\begin{equation}
\Delta t_{m} =  L \ln(m),
\label{eq:Delta_t_m}
\end{equation}

O parâmetro L na equação \ref{eq:Delta_t_m} é definido pelos parâmetros iniciais do sinal de excitação do sistema durante a caracterização e pode ser calculado através da equação \ref{Equação 5.10}
\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{figuras/10Sweep_Kernels}
	\caption{\kernels obtidos}
	\label{fig:10sweepkernels}
\end{figure}

Além da intensidade dos \kernels diminuir, eles tendem a estreitar os espaços, dificultando a separação de cada \textit{kernel} com a utilização de sistemas que utilizam ordens elevadas.
